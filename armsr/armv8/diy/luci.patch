--- a/feeds/luci/modules/luci-base/root/usr/share/rpcd/ucode/luci
+++ b/feeds/luci/modules/luci-base/root/usr/share/rpcd/ucode/luci
@@ -695,13 +695,24 @@
 
 	getOnlineUsers: {
 		call: function() {
+			let dev = 'br-lan';
+			try {
+				const ubus = connect();
+				const st = ubus?.call?.('network.interface.lan', 'status');
+				if (st)
+					dev = st.l3_device || st.device || dev;
+			} catch (e) {}
+
 			const fd = open('/proc/net/arp', 'r');
 			if (fd) {
 				let onlineusers = 0;
 
-				for (let line = fd.read('line'); length(line); line = fd.read('line'))
-					if (match(trim(line), /^.*(0x2).*(br-lan)$/))
+				for (let line = fd.read('line'); length(line); line = fd.read('line')) {
+					line = trim(line);
+					const f = split(line, /\s+/);
+					if (length(f) >= 6 && f[2] == '0x2' && f[5] == dev)
 						onlineusers++;
+				}
 
 				fd.close();
 
